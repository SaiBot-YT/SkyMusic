<!DOCTYPE html>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="user-scalable=no">
    <title>Sky Music</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
  </head>
 <link rel="stylesheet" href="style.css" type="text/css">
<body>

 
 <div class="videoWrapper video" style="background-image:url('./AnimatedBG/skygame-banner.jpg');"><div class="vsc-controller" data-vscid="jvm0gu2z7"></div>
<video preload="auto" playsinline="" muted="" autoplay="" loop="" data-vscid="jvm0gu2z7"><source src="./AnimatedBG/skygame-banner.webm" type="video/webm;codecs=&quot;vp8, vorbis&quot;"><source src="./AnimatedBG/skygame-banner.ogv" type="video/ogv;codecs=&quot;ogv, ogg, vorbis &quot;"><source src="./AnimatedBG/skygame-banner.mp4" type="video/mp4;codecs=&quot;avc1.42E01E, mp4a.40.2&quot;"></video> </div>
   <div class="Row1" id="row1"></div>
   <div class="Row2" id="row2"></div>
   <div class="Row3" id="row3"></div>
</div>
</body>
</html>

<script type="text/javascript">

  var i;
  var keyclicked;
  var element;


  //Changes the image when button clicked.
     function reply_click(clicked_id)
  {  
     i = clicked_id;
     a = i.replace(/Key/,'')
     console.log('Playing Key'+a)
     element = document.getElementById(i);
     element.style= 'background-image : url(./KeyImages/KeyClicked-'+a+'.png)';
     timer(element,a);
}

//Resets the buttons image after its clicked.
function timer(elem,aa){
setTimeout(function() {
     elem.style='background-image : url(./KeyImages/Key-'+aa+'.png)';
 } ,200);
}

//Loads the buttons with sounds
const db_url = 'https://dl.dropboxusercontent.com/s/';
const urls =["xim7yvy80ou80bi/0.mp3?dl=0", "adh4qa72jiw7q4b/1.mp3?dl=0", "546fmppbpvr80rh/2.mp3?dl=0", "aaph2izhy89oljc/3.mp3?dl=0","oia9cq7mmk7lsa0/4.mp3?dl=0","4285w5uzn5um6ay/5.mp3?dl=0", "2o1nszo0ry2ttoi/6.mp3?dl=0", "cnhjr7ljph30ycz/7.mp3?dl=0", "lqo9zv4bm6h13x4/8.mp3?dl=0", "d0brnsgqorwo67i/9.mp3?dl=0", "jq9dl35enpn4hgc/10.mp3?dl=0", "a07cku2ns81oiw2/11.mp3?dl=0", "c1gj4cn9ksctvhz/12.mp3?dl=0", "w1hhusqautlwz5w/13.mp3?dl=0", "u94o8hu4i05b0to/14.mp3?dl=0" ];
const a_ctx = new (window.AudioContext || window.webkitAudioContext)();

      preload(urls)
     .then(audioBuffers => {
      audioBuffers.forEach((buf, i) => {
      //Creates button and sets the buttons properties .
       const btn = document.createElement('button');
             btn.id = "Key"+i++
             btn.onmousedown = e => {
             const source = a_ctx.createBufferSource();
             source.buffer = buf;
             source.connect(a_ctx.destination);
             source.start(0);
             reply_click(btn.id)
       };
      //Creates the buttons and adds them to the right div.
      document.body.appendChild(btn)
      $("#Key0").appendTo("#row1") , $("#Key0").css({"background-image": "url(./KeyImages/Key-0.png)"})
      $("#Key1").appendTo("#row1") , $("#Key1").css({"background-image": "url(./KeyImages/Key-1.png)"})
      $("#Key2").appendTo("#row1") , $("#Key2").css({"background-image": "url(./KeyImages/Key-2.png)"})
      $("#Key3").appendTo("#row1") , $("#Key3").css({"background-image": "url(./KeyImages/Key-3.png)"})
      $("#Key4").appendTo("#row1") , $("#Key4").css({"background-image": "url(./KeyImages/Key-4.png)"})
     
      $("#Key5").appendTo("#row2") , $("#Key5").css({"background-image": "url(./KeyImages/Key-5.png)"})
      $("#Key6").appendTo("#row2") , $("#Key6").css({"background-image": "url(./KeyImages/Key-6.png)"})
      $("#Key7").appendTo("#row2") , $("#Key7").css({"background-image": "url(./KeyImages/Key-7.png)"})
      $("#Key8").appendTo("#row2") , $("#Key8").css({"background-image": "url(./KeyImages/Key-8.png)"})
      $("#Key9").appendTo("#row2") , $("#Key9").css({"background-image": "url(./KeyImages/Key-9.png)"})

      $("#Key10").appendTo("#row3") , $("#Key10").css({"background-image": "url(./KeyImages/Key-10.png)"})
      $("#Key11").appendTo("#row3") , $("#Key11").css({"background-image": "url(./KeyImages/Key-11.png)"})
      $("#Key12").appendTo("#row3") , $("#Key12").css({"background-image": "url(./KeyImages/Key-12.png)"})
      $("#Key13").appendTo("#row3") , $("#Key13").css({"background-image": "url(./KeyImages/Key-13.png)"})
      $("#Key14").appendTo("#row3") , $("#Key14").css({"background-image": "url(./KeyImages/Key-14.png)"})
    });
  });

function preload(urls) {
  const requests = urls.map(url => fetch(db_url + url)
    .then(r => r.arrayBuffer()) // this time we request as ArrayBuffer
    .then(b => a_ctx.decodeAudioData(b))
  );
  return Promise.all(requests);
}

const delay = ms => new Promise(res => setTimeout(res, ms));

  //Plays song when P is pressed.
  $(document).keydown(function(keyPressed) {
   if (keyPressed.keyCode == 80) {
    MarriedLife()
   }
  });

  //Preset Song 1
  var MarriedLife = async () => {
  
  //Notes
  var C1 = document.getElementById("Key0")
  var D1 = document.getElementById("Key1")
  var E1 = document.getElementById("Key2")
  var F1 = document.getElementById("Key3")
  var G1 = document.getElementById("Key4")
  var A2 = document.getElementById("Key5")
  var B2 = document.getElementById("Key6")
  var C2 = document.getElementById("Key7")
  var D2 = document.getElementById("Key8")
  var E2 = document.getElementById("Key9")
  var F3 = document.getElementById("Key10")
  var G3 = document.getElementById("Key11")
  var A3 = document.getElementById("Key12")
  var B3 = document.getElementById("Key13")
  var C3 = document.getElementById("Key14")


    F1.onmousedown()                   
  await delay(500);                      
    A2.onmousedown() + C2.onmousedown() 
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  await delay(500);
    C1.onmousedown()                   
  await delay(500);
    A2.onmousedown() + C2.onmousedown() 
  await delay(500);
    A2.onmousedown() + C2.onmousedown() 
  await delay(500);
    D1.onmousedown()      
  await delay(500);
    A2.onmousedown() + C2.onmousedown() 
  await delay(500);
    A2.onmousedown() + C2.onmousedown() 
  await delay(500);
    E1.onmousedown()  
  await delay(500);
    A2.onmousedown() + C2.onmousedown() 
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  await delay(500);
    F1.onmousedown()     
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  await delay(500);  
    A2.onmousedown() + C2.onmousedown()
  await delay(500)
    C1.onmousedown()
  await delay(500); 
    A2.onmousedown() + C2.onmousedown()      
  await delay(500); 
    A2.onmousedown() + C2.onmousedown() 
  await delay(500);   
    D1.onmousedown()
  await delay(500);
    A2.onmousedown() + C2.onmousedown() 
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  await delay(500);
    E1.onmousedown()
  await delay(500);
  //Faster part
    A2.onmousedown() + C2.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
    A2.onmousedown() + C2.onmousedown() + A3.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
  //Slower part
    F1.onmousedown() + E2.onmousedown()
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  await delay(500);
    C1.onmousedown()
  await delay(500);
  //Faster part
    A2.onmousedown() + C2.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
    A2.onmousedown() + C2.onmousedown() + A3.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
  //Slower part
    D1.onmousedown() + D2.onmousedown()
  await delay(500);
  //faster part
    A2.onmousedown() + C2.onmousedown()
  await delay(250);
    D2.onmousedown()
  await delay(250);
    A2.onmousedown() + C2.onmousedown() + F1.onmousedown()
  await delay(250);
    D2.onmousedown()
  await delay(250);
    C1.onmousedown + C2.onmousedown()
  //slower part
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  //faster part
  await delay(250);
    D2.onmousedown()
  await delay(250);
    D1.onmousedown() + A3.onmousedown()
  //slower part
  await delay(500);
    D1.onmousedown() + F1.onmousedown() + G3.onmousedown()
  await delay(500);
    D1.onmousedown() + F1.onmousedown()
  //faster part
  await delay(250);
    F3.onmousedown()
  await delay(250);
    D1.onmousedown() + A3.onmousedown()
  //slower part
  await delay(500);
    D1.onmousedown() + F1.onmousedown() + G3.onmousedown()
  await delay(500);
    D1.onmousedown() + F1.onmousedown() + F3.onmousedown()
  await delay(500);
    D1.onmousedown() + D2.onmousedown()
  await delay(500);
    D1.onmousedown() + D2.onmousedown()
  await delay(500);
    D1.onmousedown()
  await delay(500);
  //faster part
    D1.onmousedown() + F1.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
    G3.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
    C1.onmousedown() + E2.onmousedown()
    //slower part
  await delay(500);
    E1.onmousedown() + G1.onmousedown()
  await delay(500);
    E1.onmousedown() + G1.onmousedown()
  await delay(500);
    C1.onmousedown()
  //faster part
  await delay(250);
    E1.onmousedown() + G1.onmousedown()
  await delay(250);
    E2.onmousedown()
  await delay(250);
    E1.onmousedown() + G1.onmousedown() + G3.onmousedown()
  await delay(250);
    E2.onmousedown()
  await delay(250);
    C1.onmousedown() + C2.onmousedown()
  //slower part
  await delay(500);
  //faster part
    E1.onmousedown() + G1.onmousedown()
  await delay(500);
    D2.onmousedown()
  await delay(500);
    E1.onmousedown() + G1.onmousedown() + E2.onmousedown()
  await delay(500);
    C2.onmousedown()
  await delay(500);
    C1.onmousedown + G1.onmousedown
  //slower part
  await delay(500);
    E1.onmousedown() + G1.onmousedown()
  await delay(500);
    E1.onmousedown() + G1.onmousedown()
  await delay(500);
    C1.onmousedown() + F1.onmousedown()
  await delay(500);
    C2.onmousedown()
  await delay(500);
    A2.onmousedown()
  await delay(500);
    B2.onmousedown()
  await delay(500);
    C1.onmousedown + G1.onmousedown() + C2.onmousedown()
  await delay(500);
    D2.onmousedown()
  await delay(500);
    E2.onmousedown()
  await delay(500);
    C1.onmousedown() + G1.onmousedown()
  await delay(500);
    C2.onmousedown()
  await delay(500);
    D2.onmousedown()
  await delay(500);
    C1.onmousedown() + G1.onmousedown() + E2.onmousedown()
    //----------ERROR ABOVE ^^
  await delay(250);
  //fast part
    F3.onmousedown()
  await delay(250);
    A3.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
    F1.onmousedown() + E2.onmousedown()
  //slower part
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  await delay(500);
    C1.onmousedown()
  await delay(500);
  //faster part
    A2.onmousedown() + C2.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
    A2.onmousedown() + C2.onmousedown() + A3.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
    D1.onmousedown() + D2.onmousedown()
  //slower part 
  await delay(500);
  //faster part
    A2.onmousedown() + C2.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
    A2.onmousedown() + C2.onmousedown() + A3.onmousedown()
  await delay(250);
    C3.onmousedown()
  await delay(250);
    C1.onmousedown() + B3.onmousedown()
  //slower part
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  await delay(500);
    A2.onmousedown() + C2.onmousedown()
  await delay(500);
    A3.onmousedown() 
  await delay(500);
    D1.onmousedown() + C3.onmousedown()
  await delay(500);
    D1.onmousedown() + F1.onmousedown() + B3.onmousedown()
  await delay(500);
    D1.onmousedown() + F1.onmousedown()
  await delay(500);
    F3.onmousedown() + D1.onmousedown()
  await delay(500);
    D1.onmousedown() + F1.onmousedown() + G3.onmousedown()
  await delay(500);
    D1.onmousedown() + F1.onmousedown()
  await delay(500);
   F3.onmousedown()
  await delay(500);
    D1.onmousedown() + D2.onmousedown()
  await delay(500);
    D1.onmousedown() + F1.onmousedown()
  await delay(500);
    D1.onmousedown + F1.onmousedown()
  await delay(500);
    D1.onmousedown()
  //faster part
  await delay(250);
    D1.onmousedown() + F1.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
    A3.onmousedown()
  await delay(250);
    F3.onmousedown()
  await delay(250);
    C1.onmousedown() + E2.onmousedown()
  //slower part
  await delay(500);
    E1.onmousedown + G1.onmousedown
  await delay(500);
    E1.onmousedown() + G1.onmousedown()
};

</script>
